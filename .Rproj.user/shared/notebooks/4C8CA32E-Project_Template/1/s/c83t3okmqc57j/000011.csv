"0","#Ensure plyr is detached to avoid conflicts"
"0","if (""package:plyr"" %in% search()) {"
"0","  detach(""package:plyr"", unload = TRUE)"
"0","}"
"0",""
"0","#Ensure datetime is in proper format"
"0","weather_data <- weather_data %>%"
"0","  mutate(datetime = as.POSIXct(datetime, format = ""%Y-%m-%d %H:%M:%S""))"
"0",""
"0","#Combine rows by month"
"0","weather_data_processed <- weather_data %>%"
"0","  mutate("
"0","    year_month = format(as.Date(datetime), ""%Y-%m""), "
"0","  ) %>%"
"0","  group_by(year_month) %>%"
"0","  summarise("
"0","    avg_temperature = mean(hourly_temperature_2m, na.rm = TRUE), "
"0","    max_temperature = max(hourly_temperature_2m, na.rm = TRUE), "
"0","    min_temperature = min(hourly_temperature_2m, na.rm = TRUE), "
"0","    total_records = n() "
"0","  )"
